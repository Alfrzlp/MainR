repeated_md(xbar, S, C, n = 100)
C <- matrix(c(1, 1, -1, -1,
1, -1, 1, -1,
1, -1, -1, 1), byrow = T, nrow = 3)
C
# Tidal terdapat interaksi antara pemberian uang tunjangan belajar
# dengan pemberian fasilitas asrama dalam memengaruhi IPK
repeated_md(xbar, S, C, n = 100)
colname <- c('no', 'kode', 'x1', 'x2', 'x3')
read.table(textConnection(s), header = F) %>%
{rbind(
(.)[1:2] %>% `colnames<-`(colname),
(.)[3:4] %>% `colnames<-`(colname)
)}
1:length(colname)
1:length(colname) + length(colname)
read.table(textConnection(s), header = F) %>%
{rbind(
(.)[1:length(colname)] %>% `colnames<-`(colname),
(.)[1:length(colname) + length(colname)] %>% `colnames<-`(colname)
)}
s <- '1 71 0.17 0.00 0.45 31 73 0.14 0.06 0.20
2 71 0.49 0.02 1.25 32 73 0.09 0.03 0.13
3 71 0.25 0.01 0.50 33 73 0.27 0.04 0.50
4 71 0.05 0.01 0.00 34 73 0.69 0.02 2.00
5 71 0.04 0.00 0.00 35 73 0.07 0.02 0.10
6 71 0.06 0.01 0.09 36 73 0.20 0.01 0.50
7 71 0.17 0.01 0.40 37 74 0.35 0.06 0.56
8 71 0.12 0.00 0.17 38 74 0.49 0.07 1.25
9 71 0.11 0.03 0.14 39 74 0.71 0.08 2.00
10 71 0.10 0.01 0.14 40 74 1.03 0.27 3.50
11 71 0.13 0.01 0.17 41 74 0.06 0.02 0.04
12 71 0.37 0.02 0.64 42 74 0.74 0.00 2.13
13 71 0.24 0.01 0.05 43 74 1.67 0.02 6.00
14 71 0.23 0.00 0.05 44 74 0.56 0.01 1.50
15 71 0.29 0.01 0.05 45 74 0.13 0.01 0.20
16 71 0.10 0.01 0.14 46 74 0.40 0.00 0.75
17 72 0.60 0.24 1.57 47 75 0.08 0.01 0.10
18 72 0.15 0.08 0.33 48 75 3.89 0.07 6.00
19 72 0.47 0.06 1.00 49 75 0.31 0.05 0.56
20 72 0.55 0.18 1.44 50 75 0.61 0.04 2.00
21 72 0.27 0.07 0.50 51 75 0.41 0.03 0.75
22 72 0.18 0.11 0.50 52 75 0.18 0.09 0.50
23 72 0.04 0.08 0.00 53 75 0.09 5.00 0.14
24 72 0.05 0.24 0.00 54 75 0.38 0.02 0.67
25 73 0.13 0.03 0.17 55 75 0.55 0.02 1.33
26 73 0.88 0.02 2.75 56 75 0.47 0.04 1.00
27 73 0.16 0.05 0.39 57 75 1.42 0.01 4.33
28 73 0.11 0.02 0.17 58 75 0.37 0.00 0.57
29 73 0.79 0.08 2.45 59 75 0.44 0.00 1.00
30 73 0.43 0.03 1.00 NA NA NA NA NA
'
colname <- c('no', 'kode', 'x1', 'x2', 'x3')
read.table(textConnection(s), header = F) %>%
{rbind(
(.)[1:length(colname)] %>% `colnames<-`(colname),
(.)[1:length(colname) + length(colname)] %>% `colnames<-`(colname)
)}
read.table(textConnection(s), header = F) %>%
{rbind(
(.)[1:length(colname)] %>% `colnames<-`(colname),
(.)[1:length(colname) + length(colname)] %>% `colnames<-`(colname)
)} %>%
drop_na()
dat <- read.table(textConnection(s), header = F) %>%
{rbind(
(.)[1:length(colname)] %>% `colnames<-`(colname),
(.)[1:length(colname) + length(colname)] %>% `colnames<-`(colname)
)} %>%
drop_na()
length(colname)
(length(colname) + 1):(length(colname)*2)
R1 <- '1.00 -0.65 0.34
-0.65 1.00 0.42
0.34 0.42 1.00'
library(dm)
read_string(R1)
read_string(R1) %>% as.matrix()
R1 <- read_string(R1) %>% as.matrix()
R2 <- read_string('1.00 -0.65 0.34
-0.65 1.00 0.42
0.34 0.42 1.00') %>% as.matrix()
R2
R3 <- read_string('1.00 -0.59 0.43
-0.59 1.00 0.46
0.43 0.46 1.00') %>% as.matrix()
R4 <- read_string('1.00 -0.55 0.42
-0.55 1.00 0.45
0.42 0.45 1.00') %>% as.matrix()
R5 <- read_string('1.00 -0.66 0.38
-0.66 1.00 0.41
0.38 0.41 1.00') %>% as.matrix()
s <- '1. Pertanian 21650 39 93640 1250 14 12740
2. Pertambangan 20130 43 89560 1190 11 13100
3. Industri dan manufaktur 22170 41 95560 1310 12 12100
4. Jasa 16250 35 96640 1210 13 12640
5. Perdagangan 19860 44 92620 1336 15 1229'
dm::read_pattern(
s, pos_angka = c(1, 3:9),
pos_non_angka = 2
)
dm::read_pattern(
s, pos_angka = c(1, 3:8),
pos_non_angka = 2
)
dat <- dm::read_pattern(
s, pos_angka = c(1, 3:8),
pos_non_angka = 2
)
n <- c(15, 17, 18, 20, 20)
dat[,6:8]
dat[,3:5]
dat[,6:8] %>%
apply(1, diag)
dat[,6:8] %>%
apply(2, diag)
dat[,6:8] %>%
tapply(2, diag)
dat[,6:8] %>%
apply(1, function(x) diag(x))
dat[,6:8] %>%
split(1:nrow(.))
dat[,6:8] %>%
split(1:nrow(.)) %>%
lapply(function(x) diag(x))
shrtcts:::shortcut_01()
shrtcts:::shortcut_01()
library(dm)
# No 1 --------------------------------------------------------------------
n <- 12
S <- matrix(c(6947.545,  0.1778,  -0.6976,
0.1778, 13119.659, 0.1046,
-0.6976, 0.1046, 10451.356), ncol = 3, byrow = T)
S
R <- matrix(c(1,  0.1778,  -0.6976,
0.1778, 1, 0.1046,
-0.6976, 0.1046, 1), ncol = 3, byrow = T)
R
V12 <- diag(sqrt(c(6947.545, 13119.659, 10451.356)))
V12
S <- V12 %*% R %*% V12
S
R <- matrix(c(1,  0.1778,  -0.6976,
0.1778, 1, 0.1046,
-0.6976, 0.1046, 1), ncol = 3, byrow = T)
R
V12 <- diag(sqrt(c(6947.545, 13119.659, 10451.356)))
V12
S <- V12 %*% R %*% V12
S
p <- 3
s <- '13.957 13.719
10.540 10.432
17.063 16.893'
read_string(s)
read_string(s)$V1 - read_string(s)$V2
miu <- (read_string(s)$V1 - read_string(s)$V2)*1000
miu
xbar <- matrix(c(317.5, 211.25, 368.9167))
T2 <- n * t(xbar - miu) %*% solve(S) %*% (xbar - miu)
T2
# No 1 --------------------------------------------------------------------
n <- 12
p <- 3
c2 <- (n - 1) * p * qf(0.05, p, n - p, lower.tail = F) / (n - p)
c2
qf(0.05, p, n - p, lower.tail = F)
V12 <- diag(sqrt(c(6947.545, 13119.659, 10451.356)))
V12
S <- V12 %*% R %*% V12
S
t(xbar - miu)
T2
n <- 20
p <- 3
dbar <- matrix(c(-44.05, 98.35, 41.65))
s1 <- '1748,89 218,91 718,67
218,91 321,92 345,23
718,67 345,23 1216,77'
read_string(s1)
read_string(s1) %>%
mutate_all(~str_replace_all(.x, ',', '.')) %>%
type_convert()
read_string(s1) %>%
mutate_all(~str_replace_all(.x, ',', '.')) %>%
type_convert() %>%
as.matrix()
Sd <- read_string(s1) %>%
mutate_all(~str_replace_all(.x, ',', '.')) %>%
type_convert() %>%
as.matrix()
alpha <- 0.05
T2 <- n * t(dbar) %*% solve(Sd) %*% dbar
ftabel <- qf(alpha, p, n - p, lower.tail = F)
c2 <- (n - 1) * p * ftabel / (n - p)
ttabel <- qt(1 - alpha / (2 * p), n - 1)
ci <- data.frame(
lower = dbar - sqrt(c2 * diag(Sd) / n),
upper = dbar + sqrt(c2 * diag(Sd) / n),
bon.lower = dbar - ttabel * sqrt(diag(Sd) / n),
bon.upper = dbar + ttabel * sqrt(diag(Sd) / n)
)
T2
c2
p
n
ftabel
c2
n
T2
ci
dbar
diag(Sd)
n <- 12
p <- 3
s <- '13.957 13.719
10.540 10.432
17.063 16.893'
miu <- (read_string(s)$V1 - read_string(s)$V2)*1000
miu
xbar <- matrix(c(317.5, 211.25, 368.9167))
R <- matrix(c(1,  0.1778,  -0.6976,
0.1778, 1, 0.1046,
-0.6976, 0.1046, 1), ncol = 3, byrow = T)
R
V12 <- diag(sqrt(c(6947.545, 13119.659, 10451.356)))
V12
S <- V12 %*% R %*% V12
S
T2 <- n * t(xbar - miu) %*% solve(S) %*% (xbar - miu)
T2
c2 <- (n - 1) * p * qf(0.05, p, n - p, lower.tail = F) / (n - p)
c2
# Selang Kepercayaan ------------------------------------------------------
s.ci <- function(xbar, sigma, n, alpha = 0.05, adjust = F) {
p <- ncol(sigma)
if (n > 30 & adjust) {
n_kritis <- qchisq(alpha, p, lower.tail = F)
} else {
n_kritis <- (n - 1) * p * qf(alpha, p, n - p, lower.tail = F) / (n - p)
}
data.frame(
lower = xbar - sqrt(n_kritis) * sqrt(diag(sigma) / n),
upper = xbar + sqrt(n_kritis) * sqrt(diag(sigma) / n),
row.names = paste0('x', 1:p)
)
}
s.ci(xbar, S, n = n)
c2
diag9S
diag(S)
n
# No 3 --------------------------------------------------------------------
p <- 3
s3 <- 'Metstat 1 0.82 0.06 0 0 0
Statmat 0.82 1 -0.02 0 0 0
MPC 0.06 -0.02 1 0 0 0
Metstat 0 0 0 1 0.74 0.43
Statmat 0 0 0 0.74 1 0.24
MPC 0 0 0 0.43 0.24 1'
read_string(s3)
read_string(s3)[1:3, 2:4]
Sl <- read_string(s3)[1:3, 2:4]
Sl <- read_string(s3)[4:6, 5:7]
Sd <- read_string(s3)[4:6, 5:7]
Sd
Sl <- read_string(s3)[1:3, 2:4]
Sl
Sl <- read_string(s3)[1:3, 2:4] %>% as.matrix()
Sd <- read_string(s3)[4:6, 5:7] %>% as.matrix()
Rl <- read_string(s3)[1:3, 2:4] %>% as.matrix()
Rd <- read_string(s3)[4:6, 5:7] %>% as.matrix()
shrtcts:::shortcut_01()
shrtcts:::shortcut_01()
Sl <- diag(c(0.176, 0.170,0.247)) %*% Rl %*% diag(c(0.176, 0.170,0.247))
Sd <- diag(c(0.157, 0.157, 0.213)) %*% Rd %*% diag(c(0.157, 0.157, 0.213))
S1 <- diag(c(0.176, 0.170,0.247)) %*% Rl %*% diag(c(0.176, 0.170,0.247))
S2 <- diag(c(0.157, 0.157, 0.213)) %*% Rd %*% diag(c(0.157, 0.157, 0.213))
n1 <- 30
n2 <- 20
xbar_dif <- matrix(c(80.05 - 81.05, 85.06 - 83.03, 89.99 - 89.96 ))
T2 <- n1*n2/(n1 + n2)*t(xbar_dif) %*% solve(Spooled) %*% xbar_dif
n1 <- 30
n2 <- 20
Spooled <- ((n1 - 1)*S1 + (n2 - 1)*S2)/(n1 + n2 - 2)
solve(Spooled)
c2 <- (n1 + n2 - 2)*p*qf(alpha, p, n1 + n2 - p - 1, lower.tail = F)/(n1 + n2 - p - 1)
c2
S1
S2
Spooled <- ((n1 - 1)*S1 + (n2 - 1)*S2)/(n1 + n2 - 2)
Spooled
xbar_dif
T2
n1 <- 30
n2 <- 20
Spooled <- ((n1 - 1)*S1 + (n2 - 1)*S2)/(n1 + n2 - 2)
solve(Spooled)
xbar_dif <- matrix(c(80.05 - 81.05, 85.06 - 83.03, 89.99 - 89.96 ))
T2 <- n1*n2/(n1 + n2)*t(xbar_dif) %*% solve(Spooled) %*% xbar_dif
T2
Rl <- read_string(s3)[1:3, 2:4] %>% as.matrix()
Rd <- read_string(s3)[4:6, 5:7] %>% as.matrix()
S1 <- diag(c(0.176, 0.170,0.247)) %*% Rl %*% diag(c(0.176, 0.170,0.247))
S2 <- diag(c(0.157, 0.157, 0.213)) %*% Rd %*% diag(c(0.157, 0.157, 0.213))
n1 <- 30
n2 <- 20
Spooled <- ((n1 - 1)*S1 + (n2 - 1)*S2)/(n1 + n2 - 2)
solve(Spooled)
xbar_dif <- matrix(c(80.05 - 81.05, 85.06 - 83.03, 89.99 - 89.96 ))
T2 <- n1*n2/(n1 + n2)*t(xbar_dif) %*% solve(Spooled) %*% xbar_dif
T2
c2 <- (n1 + n2 - 2)*p*qf(alpha, p, n1 + n2 - p - 1, lower.tail = F)/(n1 + n2 - p - 1)
c2
# ci
data.frame(
lower = xbar_dif - sqrt(c2 * diag(Spooled) * (1/n1 + 1/n2)),
upper = xbar_dif + sqrt(c2 * diag(Spooled) * (1/n1 + 1/n2))
)
xbar_dif
diag(Spooled)
s <- 'XA 60.81 30.04 29.34 44.13 14.03 23.68
Xb 30.04 78.45 53.04 14.03 46.09 24.26
Xc 29.34 53.04 60.56 23.68 24.26 31.89'
read_string(s)
read_string(s)[5:7]
S1 <- read_string(s)[5:7]
s1 <- '58.44 22.89 39.17 82.55 63.42 41.18
Xb 22.89 78.35 54.81 63.42 109.80 81.91
Xc 39.17 54.81 66.44 41.18 81.91 85.53'
read_string(s1)
s1 <- 'xa 58.44 22.89 39.17 82.55 63.42 41.18
Xb 22.89 78.35 54.81 63.42 109.80 81.91
Xc 39.17 54.81 66.44 41.18 81.91 85.53'
read_string(s1)
S2 <- read_string(s1)[2:4]
S3 <- read_string(s1)[5:7]
W <- (12 - 1) * S1 + (11 - 1) * S2 + (11 - 1) * S3
W
xbar <- matrix(c(73.93, 89.67, 86.94))
xbar1 <- matrix(c(76.04, 90.81, 85.91))
xbar2 <- matrix(c(71.64, 91.88, 89.72) )
xbar3 <- matrix(c(73.91, 86.22, 85.28))
shrtcts:::shortcut_01()
12 * (xbar1-xbar) %*% t(xbar1-xbar) + 11 * (xbar2-xbar) %*% t(xbar2-xbar) + 11 * (xbar3-xbar) %*% t(xbar3-xbar)
B <- 12 * (xbar1-xbar) %*% t(xbar1-xbar) + 11 * (xbar2-xbar) %*% t(xbar2-xbar) + 11 * (xbar3-xbar) %*% t(xbar3-xbar)
p <- 3
g <- 3
lambda <- det(W) /  det(B + W)
W <- as.matrix(W)
B <- as.matrix(B)
# P=2 g>=2
Fhitung <- ((n - g - 1) / (g - 1)) * ((1 - sqrt(lambda))/sqrt(lambda))
Ftabel <- qf(alpha, 2*(g - 1), 2*(n - g - 1), lower.tail = F)
lambda <- det(W) /  det(B + W)
# P=2 g>=2
Fhitung <- ((n - g - 1) / (g - 1)) * ((1 - sqrt(lambda))/sqrt(lambda))
Ftabel <- qf(alpha, 2*(g - 1), 2*(n - g - 1), lower.tail = F)
lambda
# p>=1 g=3
Fhitung <- ((n - p - 2) / p) * ((1 - sqrt(lambda))/sqrt(lambda))
Ftabel <- qf(alpha, 2*p, 2*(n - p - 2), lower.tail = F)
Fhitung
Ftabel
ttabel <- qt(alpha/(p*g*(g - 1)), n -  g, lower.tail = F)
index_i = c(1:2, 1)
index_j = c(3, 3, 2)
ni <- c(12, 11, 11)
xbar_l <- rbind(xbar1, xbar2, xbar3)
# bonferoni
data.frame(
i = index_i, j = index_j,
n1 = ni[as.character(index_i)][[1]],
n2 = ni[as.character(index_j)][[1]],
xbar1 = unique(xbar_l)[index_i, 1],
xbar2 = unique(xbar_l)[index_j,1]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g))
)
ni <- c(12, 11, 11)
# bonferoni
data.frame(
i = index_i, j = index_j,
n1 = ni[as.character(index_i)][[1]],
n2 = ni[as.character(index_j)][[1]],
xbar1 = unique(xbar_l)[index_i, 1],
xbar2 = unique(xbar_l)[index_j,1]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g))
)
index_i = c(1:2, 1)
index_j = c(3, 3, 2)
ni <- c(12, 11, 11)
# bonferoni
data.frame(
i = index_i, j = index_j,
n1 = ni[as.character(index_i)][[1]],
n2 = ni[as.character(index_j)][[1]],
xbar1 = unique(xbar_l)[index_i, 1],
xbar2 = unique(xbar_l)[index_j,1]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g))
)
# bonferoni
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = unique(xbar_l)[index_i, 1],
xbar2 = unique(xbar_l)[index_j,1]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[1, 1] * (1/n1 + 1/n2)/(n - g))
)
# bonferoni
kat <- 2
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = unique(xbar_l)[index_i,  kat],
xbar2 = unique(xbar_l)[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
W
# bonferoni
kat <- 2
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = unique(xbar_l)[index_i,  kat],
xbar2 = unique(xbar_l)[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
kat
# bonferoni
kat <- 2
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = xbar_l[index_i,  kat],
xbar2 = xbar_l[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
xbar_l
xbar_l <- rbind(t(xbar1), t(xbar2), t(xbar3))
xbar_l
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = xbar_l[index_i,  kat],
xbar2 = xbar_l[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
# bonferoni
kat <- 1
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = xbar_l[index_i,  kat],
xbar2 = xbar_l[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
# bonferoni
kat <- 3
data.frame(
i = index_i, j = index_j,
n1 = c(12, 11, 12),
n2 = c(11, 11, 11),
xbar1 = xbar_l[index_i,  kat],
xbar2 = xbar_l[index_j, kat]
) %>%
mutate(
xbar_diff = xbar1 - xbar2,
lower = xbar_diff - ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g)),
upper = xbar_diff + ttabel * sqrt(W[kat, kat] * (1/n1 + 1/n2)/(n - g))
)
