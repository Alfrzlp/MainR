axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
tail(jci)
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
title = 'Jakarta Composite Index',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "1 month", date_labels =  "%b",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
title = 'Jakarta Composite Index',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "1 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
title = 'Jakarta Composite Index',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "1 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.text.x = element_text(angle = 90),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
title = 'Jakarta Composite Index',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "1 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.text.x = element_text(angle = 45),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
title = 'Jakarta Composite Index',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.text.x = element_text(angle = 0),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
ggsave(
'D:/visualisasi/return.png',
width = 6.5,
height = 4,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
# Visualisasi -------------------------------------------------------------
jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = close)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'IHSG',
title = 'Indonesia Stock Excange',
subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
# Visualisasi -------------------------------------------------------------
library(ggpubr)
ggarrange(
title = 'A'
)
c <- jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = close)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Close',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
ggarrange(
c,
title = 'A'
)
r <- jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = lnr)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Return',
# title = 'Jakarta Composite Index',
# subtitle = '02 Januari 2020 - 08 Desember 2020',
caption = expression(italic('Sumber : www.finance.yahoo.com'))
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.text.x = element_text(angle = 0),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
ggarrange(
c, r,
ncol = 1, nrow = 2,
title = 'A'
)
ggarrange(
c, r,
ncol = 1, nrow = 2
)
c <- jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = close)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = 'Date', y = 'Close'
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
ggarrange(
c, r,
ncol = 1, nrow = 2
)
fig <-
ggarrange(
c, r,
ncol = 1, nrow = 2
)
annotate_figure(figure,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14)
)
annotate_figure(fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14)
)
annotate_figure(fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14, hjust = 0)
)
annotate_figure(fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14, hjust = 1)
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14,
hjust = 1, x = 1),
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14,
hjust = 0, x = 1),
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14,
hjust = 1, x = 1),
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14,
hjust = 0, x = 0),
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 14,
hjust = 0, x = 0.1),
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 15,
hjust = 0, x = 0.05),
)
ggsave(
'D:/visualisasi/hasil.png',
width = 6.5,
height = 9,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
ggsave(
'D:/visualisasi/hasil.png',
width = 9,
height = 8,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
ggsave(
'D:/visualisasi/hasil.png',
width = 6.5,
height = 4,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
c <- jci %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = close)) +
geom_line(lwd = 0.7, colour = "steelblue") +
labs(
x = NULL, y = 'Close'
) +
# biar gak ada yang kepotong
coord_cartesian(clip = "off") +
theme_minimal(
base_family = "Arial Narrow",
base_size = 13
) +
scale_x_date(
date_breaks = "3 month", date_labels =  "%b %Y",
limits = c(as.Date('2020-01-01'), as.Date('2021-12-08'))
) +
theme(
plot.title.position = "plot",
text = element_text(colour = "gray30"),
plot.title = element_text(family = "Arial", face = "bold",
colour = "black", size = rel(1.75)),
axis.title.y = element_text(hjust = 1, colour = "gray5"),
axis.title.x = element_text(hjust = 0, colour = "gray5"),
axis.line = element_line(colour = "gray70"),
axis.ticks = element_line(colour = 'gray70'),
plot.margin = margin(15, 15, 15, 15)
)
fig <-
ggarrange(
c, r,
ncol = 1, nrow = 2
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "steelblue", face = "bold", size = 15,
hjust = 0, x = 0.05)
)
ggsave(
'D:/visualisasi/hasil.png',
width = 6.5,
height = 4,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
annotate_figure(
fig,
top = text_grob("Jakarta Composite Index", color = "black", face = "bold", size = 15,
hjust = 0, x = 0.05)
)
ggsave(
'D:/visualisasi/hasil.png',
width = 6.5,
height = 4,
limitsize = F,
dpi = 300,
type = "cairo-png"
)
dim(jci)
summary(jci)
var(jci$close, na.rm = T)
moments::skewness(jci$close, na.rm = T)
moments::kurtosis(jci$close, na.rm = T)
remotes::install_github("zaenalium/rewlr")
remotes::install_github("zaenalium/rewlr")
uninstall('pROC')
remove.packages('pROC')
remotes::install_github("zaenalium/rewlr")
remotes::install_github("zaenalium/rewlr")
library(rewlr)
data(National_exam_id)
#data$Species <- ifelse(data$Species == "setosa",0,1)
#Supposed that current sample data has 9 percent of rare event data, and the population has 2 percent of those rare event data.
(weight0 = (1 - 0.09)/(1-0.02))
(weight1 = (0.09)/(0.02))
iter = 1000; tol = 0.00001
fit <- rewlr(y~., data = National_exam_id, weights0 = weight0, weights1 = weight1)
summary(fit)
p <- predict(fit, newdata = National_exam_id)
fit
dim(National_exam_id)
National_exam_id
p <- predict(fit, newdata = National_exam_id)
iris
iris %>%
dplyr::filter(Species != 'versicolor')
fit
glm(y~., data = National_exam_id, family = binomial)
m1 <- glm(y~., data = National_exam_id, family = binomial)
m1 %>% predict()
pred <- m1 %>% predict(type = 'respons')
pred
ifelse(pred >= 0.5, 1, 0)
pred <- ifelse(pred >= 0.5, 1, 0)
caret::confusionMatrix(National_exam_id$y, pred)
National_exam_id$y
pred <- ifelse(pred >= 0.5, 1, 0) %>% as.factor()
caret::confusionMatrix(National_exam_id$y, pred)
pred
actual <- National_exam_id$y
actual
actual %>% as.factor()
actual <- National_exam_id$y %>% as.factor()
actual
caret::confusionMatrix(actual, pred)
fit$fitted
pred <- ifelse(fit$fitted >= 0.5, 1, 0) %>% as.factor()
pred
caret::confusionMatrix(actual, pred)
pred <- ifelse(fit$fitted >= 0.65, 1, 0) %>% as.factor()
pred
caret::confusionMatrix(actual, pred)
pred1 <- ifelse(pred >= 0.65, 1, 0) %>% as.factor()
pred1
pred1 <- ifelse(pred1 >= 0.65, 1, 0) %>% as.factor()
pred1 <- m1 %>% predict(type = 'respons')
pred1 <- ifelse(pred1 >= 0.65, 1, 0) %>% as.factor()
pred1
caret::confusionMatrix(actual, pred1)
caret::confusionMatrix(actual, pred)
install.packages("MLmetrics")
MLmetrics::F1_Score(actual, pred1)
MLmetrics::F1_Score(actual, pred)
MLmetrics::F1_Score(actual, pred, positive = F)
MLmetrics::F1_Score(actual, pred, 'neg')
MLmetrics::F1_Score(actual, pred, 'negative')
