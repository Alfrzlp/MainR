---
title: "Plot Indonesia Per kabupaten"
author: "Ridson Alfarizal"
date: "18/10/2020"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---
# Tutorial {.tabset}
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Membuat plot Indonesia
### __Data GADM indonesia bisa di download di__ [link](https://gadm.org/download_country_v3.html)
pilih shapefile

### __Import library__
```{r message=FALSE, warning=TRUE}
library(rgdal)
```

### Membaca Folder _gadm36_IDN_shp_ dan mengambil _layer gadm36_IDN_2_
yaitu layer 2 tingkat kabupaten
```{r}
indo = readOGR(dsn = "D:/Datasets/gadm36_IDN_shp", layer = "gadm36_IDN_2", stringsAsFactors = F)
```

### __Plot dengan ggplot2__
data harus diubah menjadi data frame terlebih dahulu agar dapat diplot dengan ggplot
```{r warning=TRUE}
library(ggplot2)
indonesia = fortify(indo, region = "NAME_2")
dataindo = indo@data
colnames(dataindo)[7] = "id"

#menampilkan data indo
library(knitr)
kable(dataindo[1:5,], caption = "dataindo")
```

```{r, message=FALSE}
library(dplyr)
```

```{r, fig.width=9}
indonesia = left_join(indonesia, dataindo, by="id")

library(ggplot2)
ggplot(indonesia, aes(x=long, y=lat)) + 
  geom_map(map=indonesia, aes(map_id=id), color="white", size=0.5)
```

## Membuat plot Jawa Timur
### __mengambil subset data Jawa Timur__
```{r, fig.width=9}
jawatimur = indonesia %>% filter(NAME_1 == "Jawa Timur")
kable(jawatimur[1:5,])

#Membuat posisi nama kab jawa timur
kab_jatim <- jawatimur %>% group_by(id) %>% 
  summarise(long = mean(long), lat = mean(lat))

#Plot Jatim
ggplot(jawatimur, aes(x=long, y=lat)) + 
  geom_map(map=jawatimur, aes(map_id=id, fill=id), color="white", size=0.5) +
  geom_text(aes(x=long, y=lat, label = id), data=kab_jatim, size=3) +
  scale_fill_viridis_d(option = "D") +
  ylim(NA, -6.4) + xlim(NA, 116) + 
  theme(legend.position = "none")
```

### __Mengabungkan dengan data hutan jawa timur__
```{r, fig.width=9}
hutan <- read.csv("D:/Datasets/kebun_jatim.csv", sep = ";")
colnames(hutan)[1] <- "id"
kable(hutan[1:5,])

jawatimur <- left_join(jawatimur, hutan, by="id")

#membetulkan nama kolom
library(janitor)
jawatimur <- clean_names(jawatimur)
kable(jawatimur[1:5,])

#plot polygon luas hutan dan perairan
ggplot(jawatimur, aes(x=long, y=lat)) +
  geom_polygon(aes(group=group, fill=jumlah_luas_hutan_dan_perairan), color = "white") +
  geom_text(aes(x=long, y=lat, label = id), data=kab_jatim, size=2) +
  labs(subtitle = "Dari data BPS Jawa Timur", fill="Luas Hutan & Perairan (Hektar)") + ylim(NA, -6.4) + xlim(NA, 116) + 
  scale_fill_viridis_c(option = "D", direction = -1) +
  ggtitle("Jumlah Luas Hutan dan Perairan Provinsi Jawa Timur Tahun 2018") + coord_map()
```


