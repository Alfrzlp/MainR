library(MASS)
library(lmtest)
library(tidyverse)

# data --------------------------------------------------------------------
dat <- readxl::read_xlsx('D:/_Datasets/TDIIPaper_fix.xlsx')
head(dat)


formula1 <- jki ~ k4 + ttd + td2 + p_fasyankes + rbidan + kih + p4k
formula1 <- jki ~ k4 + ttd + td2 + p_fasyankes + rbidan + kih + p4k
# multikolinearitas -------------------------------------------------------
car::vif(glm(formula1, data = dat, family = 'poisson'))

# Poisson model -----------------------------------------------------------
pm <- glm(formula1, data = dat, family = 'poisson')
summary(pm)


# equidispersion test -----------------------------------------------------
deviance(pm) / df.residual(pm)

# Negtaive Binomial Model -------------------------------------------------
nbm <- glm.nb(formula1, data = dat)
summary(nbm)

nbm <- step(nbm)
summary(nbm)
# parameter dispersi
deviance(nbm) / df.residual(nbm)


# Uji Simultan  ------------------------------------------------------
nbm_intercept <- glm.nb(jki ~ 1, data = dat)
lrtest(nbm_intercept, nbm)

# nilai koef
(exp(coef(nbm))[-1] - 1) * 100

# Goodnes of fit ----------------------------------------------------------
lrtest(pm, nbm)








# Data --------------------------------------------------------------------
s <- '1 Aceh 115.422 157 114.623 173
2 Sumatera Utara 302.555 202 299.198 187
3 Sumatera Barat 109.431 116 108.653 125
4 Riau 154.878 119 155.322 129
5 Jambi 65.762 59 65.427 62
6 Sumatera Selatan 159.908 105 158.251 128
7 Bengkulu 37.103 35 36.917 32
8 Lampung 150.245 111 147.694 115
9 Kepulauan Bangka Belitung 27.429 36 27.476 26
10 Kepulauan Riau 41.058 41 40.568 38
11 DKI Jakarta 166.696 100 163.138 117
12 Jawa Barat 873.575 684 880.250 745
13 Jawa Tengah 527.433 416 522.802 530
14 DI Yogyakarta 54.127 36 41.896 40
15 Jawa Timur 566.300 520 562.006 565
16 Banten 240.174 212 237.844 242
17 Bali 64.541 45 64.417 56
18 Nusa Tenggara Barat 103.315 97 102.477 122
19 Nusa Tenggara Timur 139.136 93 140.603 151
20 Kalimantan Barat 100.232 117 99.378 115
21 Kalimantan Tengah 53.804 74 53.783 68
22 Kalimantan Selatan 80.440 63 79.621 97
23 Kalimantan Timur 74.937 79 75.011 92
24 Kalimantan Utara 12.139 21 12.146 18
25 Sulawesi Utara 40.802 51 40.496 48
26 Sulawesi Tengah 62.707 97 62.469 81
27 Sulawesi Selatan 168.185 144 167.083 133
28 Sulawesi Tenggara 56.906 66 56.438 61
29 Gorontalo 23.856 40 23.894 56
30 Sulawesi Barat 32.851 49 33.034 46
31 Maluku 44.630 52 44.803 70
32 Maluku Utara 29.195 47 29.282 39
33 Papua Barat 21.850 47 21.990 48
34 Papua 71.339 66 71.352 72'

dt1 <- 
  dm::read_pattern(
    s, pos_non_angka = 2,
    pos_angka = c(1, 3:6)
  ) %>% 
  mutate_at(c(3, 5), ~str_replace_all(.x, '\\.', '')) %>% 
  type_convert() %>% 
  mutate(
    aki = v6*100000/v5
  ) %>% 
  dplyr::select(v2, jlh = v5, jki = v6)

dt1

s1 <- '1 Aceh 126.085 112.986 89,6 96.673 76,7 120.354 100.689 83,7 96.999 80,6 100.063 83,1 93.736 77,9 98.741 82,0
2 Sumatera Utara 329.118 281.762 85,6 262.602 79,8 314.158 261.338 83,2 257.425 81,9 263.949 84,0 243.553 77,5 245.989 78,3
3 Sumatera Barat 119.518 99.426 83,2 87.011 72,8 114.086 86.478 75,8 87.049 76,3 87.734 76,9 84.741 74,3 87.785 76,9
4 Riau 170.854 142.968 83,7 78.189 45,8 163.088 131.215 80,5 80.275 49,2 132.246 81,1 119.127 73,0 130.827 80,2
5 Jambi 71.970 71.504 99,4 64.193 89,2 68.698 63.242 92,1 57.211 83,3 64.011 93,2 62.582 91,1 63.964 93,1
6 Sumatera Selatan 174.076 163.956 94,2 158.252 90,9 166.164 152.721 91,9 147.611 88,8 152.470 91,8 146.953 88,4 150.676 90,7
7 Bengkulu 40.609 38.017 93,6 35.163 86,6 38.763 34.148 88,1 33.826 87,3 34.105 88,0 32.291 83,3 33.964 87,6
8 Lampung 162.463 152.289 93,7 151.066 93,0 155.079 143.155 92,3 140.736 90,8 143.087 92,3 138.934 89,6 140.099 90,3
9 Kep. Bangka Belitung 30.224 27.808 92,0 27.808 92,0 28.850 26.059 90,3 25.286 87,6 26.035 90,2 25.579 88,7 26.133 90,6
10 Kepulauan Riau 44.625 44.549 99,8 42.387 95,0 42.596 41.331 97,0 40.865 95,9 41.337 97,0 38.652 90,7 41.201 96,7
11 DKI Jakarta 179.452 180.563 100,6 177.413 98,9 171.295 170.568 99,6 170.568 99,6 170.589 99,6 168.934 98,6 170.199 99,4
12 Jawa Barat 955.411 972.437 101,8 917.642 96,0 922.883 877.130 95,0 867.574 94,0 895.723 97,1 881.457 95,5 899.078 97,4
13 Jawa Tengah 575.082 573.352 99,7 542.212 94,3 548.942 541.122 98,6 532.562 97,0 530.879 96,7 524.800 95,6 532.333 97,0
14 DI Yogyakarta 59.422 45.586 76,7 39.625 66,7 43.775 41.033 93,7 41.013 93,7 40.977 93,6 38.928 88,9 40.578 92,7
15 Jawa Timur 618.207 604.004 97,7 563.342 91,1 590.106 572.588 97,0 561.096 95,1 573404 97,2 563.834 95,5 472.047 80,0
16 Banten 261.628 268.616 102,7 252.716 96,6 249.736 270.572 108,3 245.855 98,4 255.297 102,2 307.024 122,9 266.046 106,5
17 Bali 70.859 71.849 101,4 67.241 94,9 67.638 66.674 98,6 66.603 98,5 66.683 98,6 65.548 96,9 66.407 98,2
18 Nusa Tenggara Barat 112.725 118.415 105,0 108.146 95,9 107.601 105.226 97,8 104.846 97,4 104.242 96,9 104.242 96,9 104.708 97,3
19 Nusa Tenggara Timur 154.663 106.131 68,6 83.827 54,2 147.633 94.412 64,0 89.298 60,5 97.016 65,7 91.771 62,2 96.186 65,2
20 Kalimantan Barat 109.316 99.510 91,0 89.111 81,5 104.347 84.687 81,2 76.389 73,2 87.815 84,2 84.019 80,5 87.830 84,2
21 Kalimantan Tengah 59.161 52.843 89,3 47.589 80,4 56.472 45.985 81,4 37.805 66,9 48.201 85,4 45.723 81,0 48.428 85,8
22 Kalimantan Selatan 87.583 70.804 80,8 67.770 77,4 83.602 71.877 86,0 67.522 80,8 70.216 84,0 67.866 81,2 70.447 84,3
23 Kalimantan Timur 82.512 73.810 89,5 26.583 32,2 78.762 68.275 86,7 27.658 35,1 68.724 87,3 63.039 80,0 63.509 80,6
24 Kalimantan Utara 13.361 14.536 108,8 12.919 96,7 12.753 13.231 103,7 12.598 98,8 13.281 104,1 12.648 99,2 13.189 103,4
25 Sulawesi Utara 44.546 42.229 94,8 36.475 81,9 42.521 35.429 83,3 33.876 79,7 34.747 81,7 33.837 79,6 34.680 81,6
26 Sulawesi Tengah 68.716 61.653 89,7 55.072 80,1 65.592 54.008 82,3 52.618 80,2 54.456 83,0 51.586 78,6 53.166 81,1
27 Sulawesi Selatan 183.791 168.111 91,5 152.993 83,2 175.437 154.871 88,3 153.336 87,4 154.942 88,3 149.776 85,4 153.993 87,8
28 Sulawesi Tenggara 69.018 59.263 85,9 46.613 67,5 58.917 51.208 86,9 48.574 82,4 51.769 87,9 49.256 83,6 50.769 86,2
29 Gorontalo 26.283 0 0,0 20.268 77,1 25.089 0 0,0 21.878 87,2 0 0,0 0 0,0 0 0,0
30 Sulawesi Barat 36.337 27.857 76,7 24.070 66,2 34.686 17.005 49,0 24.632 71,0 17.431 50,3 25.390 73,2 27.352 78,9
31 Maluku 49.283 38.721 78,6 31.689 64,3 47.043 21.983 46,7 14.772 31,4 23.101 49,1 21.039 44,7 22.442 47,7
32 Maluku Utara 32.210 27.710 86,0 22.775 70,7 30.746 23.191 75,4 21.360 69,5 24.010 78,1 23.515 76,5 23.408 76,1
33 Papua Barat 24.189 13.798 57,0 8.334 34,5 23.090 11.118 48,2 8.005 34,7 8.442 36,6 7.096 30,7 7.826 33,9
34 Papua 78.487 46.378 59,1 21.550 27,5 74.920 37.273 49,8 33.412 44,6 29.165 38,9 23.631 31,5 27.738 37,0'

library(dm)

dt2 <- 
  read_pattern(
    s1, pos_non_angka = 2,
    pos_angka = c(1, 3:18)
  ) %>% 
  dplyr::select(
    v2, k1 = v5, k4 = v7, ditolong_nakes = v10, 
    p_fasyankes = v12, kflengkap = v16, ibu_nifas_vita = v18,
  ) %>% 
  mutate_at(-1, ~str_replace_all(.x, ',', '.')) %>% 
  type_convert() %>% 
  mutate(
    v2 = ifelse(v2 == 'Kep. Bangka Belitung', 'Kepulauan Bangka Belitung', v2)
  )

dt2

s2 <- '1 Aceh 126.085 89.701 71,1
2 Sumatera Utara 329.118 220.467 67,0
3 Sumatera Barat 119.518 90.385 75,6
4 Riau 170.854 131.996 77,3
5 Jambi 71.970 64.833 90,1
6 Sumatera Selatan 174.076 145.095 83,4
7 Bengkulu 40.609 34.816 85,7
8 Lampung 162.463 152.790 94,0
9 Kepulauan Bangka Belitung 30.224 25.758 85,2
10 Kepulauan Riau 44.625 42.146 94,4
11 DKI Jakarta 179.452 178.244 99,3
12 Jawa Barat 955.411 910.811 95,3
13 Jawa Tengah 575.082 492.813 85,7
14 DI Yogyakarta 59.422 40.061 67,4
15 Jawa Timur 618.207 549.805 88,9
16 Banten 261.628 238.840 91,3
17 Bali 70.859 68.096 96,1
18 Nusa Tenggara Barat 112.725 107.871 95,7
19 Nusa Tenggara Timur 154.663 92.243 59,6
20 Kalimantan Barat 109.316 90.768 83,0
21 Kalimantan Tengah 59.161 45.902 77,6
22 Kalimantan Selatan 87.583 69.399 79,2
23 Kalimantan Timur 82.512 61.372 74,4
24 Kalimantan Utara 13.361 12.885 96,4
25 Sulawesi Utara 44.546 38.334 86,1
26 Sulawesi Tengah 68.716 55.287 80,5
27 Sulawesi Selatan 183.791 150.577 81,9
28 Sulawesi Tenggara 69.018 43.778 63,4
29 Gorontalo 26.283 20.121 76,6
30 Sulawesi Barat 36.337 23.712 65,3
31 Maluku 49.283 25.049 50,8
32 Maluku Utara 32.210 22.242 69,1
33 Papua Barat 24.189 7213 29,8
34 Papua 78.487 19.859 25,3'

dt3 <- 
  read_pattern(
    s2, pos_non_angka = 2,
    pos_angka = c(1, 3:5)
  ) %>% 
  dplyr::select(v2, ttd = v5) %>% 
  mutate_at(-1, ~str_replace_all(.x, ',', '.')) %>%
  type.convert()

dat <- dt1 %>% 
  left_join(dt2) %>% 
  left_join(dt3) %>% 
  left_join(dat4) %>% 
  left_join(dat5) %>% 
  left_join(dat6) %>% 
  left_join(dat7)
# k4 ttd
# IMUNISASI Td2+ PADA IBU HAMIL
# PERSALINAN DI FASILITAS PELAYANAN KESEHATAN 
# DETEKSI DINI HEPATITIS B


# -------------------------------------------------------------------------


s3 <- '1 Aceh 126.085 21.842 17,3 22.452 17,8 18.456 14,6 12.282 9,7 9.709 7,7 62.899 49,9
2 Sumatera Utara 329.118 0 0,0 0 0,0 0 0,0 0 0,0 0 0,0 0 0,0
3 Sumatera Barat 119.518 9.968 8,3 11.478 9,6 10.147 8,5 8.885 7,4 8.948 7,5 39.458 33,0
4 Riau 170.854 7.045 4,1 8.752 5,1 12.795 5,0 12.859 7,5 14.283 8,4 48.689 28,5
5 Jambi 71.970 12.565 17,5 13.516 18,8 10.484 14,6 7.848 10,9 6.427 8,9 38.275 53,2
6 Sumatera Selatan 174.076 59.120 34,0 56.959 32,7 25.502 12,8 22.333 12,8 20.641 11,9 125.435 72,1
7 Bengkulu 40.609 6.301 15,5 6.378 15,7 4.986 6,6 5.388 13,3 4.982 12,3 21.734 53,5
8 Lampung 162.463 932 0,6 898 0,6 1.189 0,7 1.500 0,9 1.666 1,0 5.253 3,2
9 Kepulauan Bangka Belitung 30.224 385 1,3 909 3,0 2518 0,0 2994 9,9 4248 14,1 10669 35,3
10 Kepulauan Riau 44.625 5.807 13,0 5.515 12,4 4.835 10,5 4.977 11,2 5.534 12,4 20.861 46,7
11 DKI Jakarta 179.452 17.046 9,5 20.405 11,4 22.950 12,8 20.920 11,7 24.668 13,7 88.943 49,6
12 Jawa Barat 955.411 449.119 47,0 409.160 42,8 177.228 17,9 104.615 10,9 74.203 7,8 765.206 80,1
13 Jawa Tengah 575.082 90.290 15,7 76.188 13,2 76.140 10,3 84.356 14,7 97.655 17,0 334.339 58,1
14 DI Yogyakarta 59.422 51 0,1 528 0,9 9.181 16,6 11.965 20,1 21.745 36,6 43.419 73,1
15 Jawa Timur 618.207 26.171 4,2 22.961 3,7 40.142 5,8 63.976 10,3 410.271 66,4 537.350 86,9
16 Banten 261.628 92.301 35,3 86.246 33,0 32.047 12,2 21.274 8,1 16.348 6,2 155.915 59,6
17 Bali 70.859 22 0,0 155 0,2 1.152 1,6 4.574 6,5 26.276 37,1 32.157 45,4
18 Nusa Tenggara Barat 112.725 24.725 21,9 24.831 22,0 19.163 15,8 13.625 12,1 10.953 9,7 68.572 60,8
19 Nusa Tenggara Timur 154.663 19.870 12,8 16.789 10,9 11.550 6,8 6.490 4,2 5.915 3,8 40.744 26,3
20 Kalimantan Barat 109.316 9.872 9,0 10.846 9,9 10.002 0,0 9.045 8,3 9.660 8,8 39.553 36,2
21 Kalimantan Tengah 59.161 13.123 22,2 11.583 19,6 5.524 8,5 3.926 6,6 3.201 5,4 24.234 41,0
22 Kalimantan Selatan 87.583 12.533 14,3 16.803 19,2 12.922 6,0 7.700 8,8 4.211 4,8 41.636 47,5
23 Kalimantan Timur 82.512 5387 6,5 5545 6,7 4386 0,0 3677 4,5 4163 5,0 17.771 21,5
24 Kalimantan Utara 13.361 394 2,9 546 4,1 514 3,5 544 4,1 607 4,5 2.211 16,5
25 Sulawesi Utara 44.546 1.903 4,3 1.443 3,2 467 0,9 214 0,5 155 0,3 2.279 5,1
26 Sulawesi Tengah 68.716 15.233 22,2 16.570 24,1 13.591 12,9 10.496 15,3 9.185 13,4 49.842 72,5
27 Sulawesi Selatan 183.791 63.875 34,8 54.154 29,5 25.552 11,0 15.424 8,4 11.715 6,4 106.845 58,1
28 Sulawesi Tenggara 69.018 17.998 26,1 15.732 22,8 8.118 10,5 5.180 7,5 4.384 6,4 33.414 48,4
29 Gorontalo 26.283 13.222 50,3 11.982 45,6 1.844 7,0 818 3,1 779 3,0 15.423 58,7
30 Sulawesi Barat 36.337 5.921 16,3 5.469 15,1 4.039 11,1 2.091 5,8 1.650 4,5 13.249 36,5
31 Maluku 49.283 17.085 34,7 13.408 27,2 5.171 4,1 3.136 6,4 2.682 5,4 24.397 49,5
32 Maluku Utara 32.210 16.212 50,3 13.852 43,0 3.624 1,2 1.705 5,3 1.498 4,7 20.679 64,2
33 Papua Barat 24.189 1959 8,1 1902 7,9 1804 6,6 1375 5,7 2288 9,5 7.369 30,5
34 Papua 78.487 12.010 15,3 8.066 10,3 4.694 5,2 2.581 3,3 2.847 3,6 18.188 23,2
'



s4 <- '1 Aceh 359 248 69,08 0 0,00 105
2 Sumatera Utara 608 452 74,34 586 96,38 233
3 Sumatera Barat 276 218 78,99 0 0,00 0
4 Riau 231 202 87,45 0 0,00 42
5 Jambi 207 204 98,55 203 98,07 50
6 Sumatera Selatan 341 341 100,00 341 100,00 101
7 Bengkulu 179 176 98,32 179 100,00 60
8 Lampung 312 292 93,59 71 22,76 0
9 Kepulauan Bangka Belitung 64 64 100,00 64 100,00 21
10 Kepulauan Riau 88 80 90,91 86 97,73 14
11 DKI Jakarta 315 153 48,57 0 0,00 0
12 Jawa Barat 1.083 790 72,95 1.010 93,26 51
13 Jawa Tengah 878 357 40,66 0 0,00 0
14 DI Yogyakarta 121 119 98,35 0 0,00 1
15 Jawa Timur 968 568 58,68 915 94,52 22
16 Banten 245 241 98,37 245 100,00 0
17 Bali 120 73 60,83 120 100,00 18
18 Nusa Tenggara Barat 174 173 99,43 173 99,43 6
19 Nusa Tenggara Timur 410 113 27,56 0 0,00 0
20 Kalimantan Barat 246 211 85,77 70 28,46 74
21 Kalimantan Tengah 205 158 77,07 189 92,20 53
22 Kalimantan Selatan 236 227 96,19 236 100,00 49
23 Kalimantan Timur 187 86 45,99 183 97,86 42
24 Kalimantan Utara 55 55 100,00 37 67,27 27
25 Sulawesi Utara 195 193 98,97 0 0,00 0
26 Sulawesi Tengah 207 173 83,57 207 100,00 72
27 Sulawesi Selatan 461 391 84,82 461 100,00 194
28 Sulawesi Tenggara 292 277 94,86 291 99,66 0
29 Gorontalo 93 93 100,00 0 0,00 0
30 Sulawesi Barat 96 76 79,17 70 72,92 0
31 Maluku 215 153 71,16 210 97,67 0
32 Maluku Utara 147 139 94,56 143 97,28 0
33 Papua Barat 161 14 8,70 0 0,00 13
34 Papua 428 24 5,61 0 0,00 0'

dat4 <- read_pattern(
  s4, pos_non_angka = 2,
  pos_angka = c(1, 3:8)
) %>% 
  mutate_at(c(5, 7), ~str_replace_all(.x, ',', '.')) %>% 
  mutate_at(c(3, 6), ~str_replace_all(.x, '\\.', '')) %>% 
  type_convert() %>% 
  dplyr::select(v2, jp = v3, kih = v5, p4k = v7, rtk = v8)


s5 <- '1 Aceh 126.085 21.842 17,3 22.452 17,8 18.456 14,6 12.282 9,7 9.709 7,7 62.899 49,9
2 Sumatera Utara 329.118 0 0,0 0 0,0 0 0,0 0 0,0 0 0,0 0 0,0
3 Sumatera Barat 119.518 9.968 8,3 11.478 9,6 10.147 8,5 8.885 7,4 8.948 7,5 39.458 33,0
4 Riau 170.854 7.045 4,1 8.752 5,1 12.795 5,0 12.859 7,5 14.283 8,4 48.689 28,5
5 Jambi 71.970 12.565 17,5 13.516 18,8 10.484 14,6 7.848 10,9 6.427 8,9 38.275 53,2
6 Sumatera Selatan 174.076 59.120 34,0 56.959 32,7 25.502 12,8 22.333 12,8 20.641 11,9 125.435 72,1
7 Bengkulu 40.609 6.301 15,5 6.378 15,7 4.986 6,6 5.388 13,3 4.982 12,3 21.734 53,5
8 Lampung 162.463 932 0,6 898 0,6 1.189 0,7 1.500 0,9 1.666 1,0 5.253 3,2
9 Kepulauan Bangka Belitung 30.224 385 1,3 909 3,0 2518 0,0 2994 9,9 4248 14,1 10669 35,3
10 Kepulauan Riau 44.625 5.807 13,0 5.515 12,4 4.835 10,5 4.977 11,2 5.534 12,4 20.861 46,7
11 DKI Jakarta 179.452 17.046 9,5 20.405 11,4 22.950 12,8 20.920 11,7 24.668 13,7 88.943 49,6
12 Jawa Barat 955.411 449.119 47,0 409.160 42,8 177.228 17,9 104.615 10,9 74.203 7,8 765.206 80,1
13 Jawa Tengah 575.082 90.290 15,7 76.188 13,2 76.140 10,3 84.356 14,7 97.655 17,0 334.339 58,1
14 DI Yogyakarta 59.422 51 0,1 528 0,9 9.181 16,6 11.965 20,1 21.745 36,6 43.419 73,1
15 Jawa Timur 618.207 26.171 4,2 22.961 3,7 40.142 5,8 63.976 10,3 410.271 66,4 537.350 86,9
16 Banten 261.628 92.301 35,3 86.246 33,0 32.047 12,2 21.274 8,1 16.348 6,2 155.915 59,6
17 Bali 70.859 22 0,0 155 0,2 1.152 1,6 4.574 6,5 26.276 37,1 32.157 45,4
18 Nusa Tenggara Barat 112.725 24.725 21,9 24.831 22,0 19.163 15,8 13.625 12,1 10.953 9,7 68.572 60,8
19 Nusa Tenggara Timur 154.663 19.870 12,8 16.789 10,9 11.550 6,8 6.490 4,2 5.915 3,8 40.744 26,3
20 Kalimantan Barat 109.316 9.872 9,0 10.846 9,9 10.002 0,0 9.045 8,3 9.660 8,8 39.553 36,2
21 Kalimantan Tengah 59.161 13.123 22,2 11.583 19,6 5.524 8,5 3.926 6,6 3.201 5,4 24.234 41,0
22 Kalimantan Selatan 87.583 12.533 14,3 16.803 19,2 12.922 6,0 7.700 8,8 4.211 4,8 41.636 47,5
23 Kalimantan Timur 82.512 5387 6,5 5545 6,7 4386 0,0 3677 4,5 4163 5,0 17.771 21,5
24 Kalimantan Utara 13.361 394 2,9 546 4,1 514 3,5 544 4,1 607 4,5 2.211 16,5
25 Sulawesi Utara 44.546 1.903 4,3 1.443 3,2 467 0,9 214 0,5 155 0,3 2.279 5,1
26 Sulawesi Tengah 68.716 15.233 22,2 16.570 24,1 13.591 12,9 10.496 15,3 9.185 13,4 49.842 72,5
27 Sulawesi Selatan 183.791 63.875 34,8 54.154 29,5 25.552 11,0 15.424 8,4 11.715 6,4 106.845 58,1
28 Sulawesi Tenggara 69.018 17.998 26,1 15.732 22,8 8.118 10,5 5.180 7,5 4.384 6,4 33.414 48,4
29 Gorontalo 26.283 13.222 50,3 11.982 45,6 1.844 7,0 818 3,1 779 3,0 15.423 58,7
30 Sulawesi Barat 36.337 5.921 16,3 5.469 15,1 4.039 11,1 2.091 5,8 1.650 4,5 13.249 36,5
31 Maluku 49.283 17.085 34,7 13.408 27,2 5.171 4,1 3.136 6,4 2.682 5,4 24.397 49,5
32 Maluku Utara 32.210 16.212 50,3 13.852 43,0 3.624 1,2 1.705 5,3 1.498 4,7 20.679 64,2
33 Papua Barat 24.189 1959 8,1 1902 7,9 1804 6,6 1375 5,7 2288 9,5 7.369 30,5
34 Papua 78.487 12.010 15,3 8.066 10,3 4.694 5,2 2.581 3,3 2.847 3,6 18.188 23,2'

dat5 <- read_pattern(
  s5, pos_non_angka = 2,
  pos_angka = c(1, 3:15)
) %>% 
  mutate_at(-2, ~str_replace_all(.x, '\\.', '')) %>% 
  mutate_at(-2, ~str_replace_all(.x, ',', '\\.')) %>% 
  type_convert() %>% 
  dplyr::select(
    v2, td2 = v15
  )

s6 <- '1 Aceh 72,2 89,1
2 Sumatera Utara 95,7 96,3
3 Sumatera Barat 89,8 95,1
4 Riau 96,0 98,3
5 Jambi 97,0 98,7
6 Sumatera Selatan 99,2 96,6
7 Bengkulu 94,8 96,4
8 Lampung 91,9 95,3
9 Kepulauan Bangka Belitung 90,2 98,7
10 Kepulauan Riau 98,7 100,0
11 DKI Jakarta 97,5 98,2
12 Jawa Barat 51,0 66,4
13 Jawa Tengah 92,1 95,8
14 DI Yogyakarta 98,1 99,9
15 Jawa Timur 73,1 80,9
16 Banten 85,0 99,9
17 Bali 100,0 100,0
18 Nusa Tenggara Barat 79,0 91,0
19 Nusa Tenggara Timur 64,2 90,0
20 Kalimantan Barat 93,0 95,9
21 Kalimantan Tengah 95,6 99,7
22 Kalimantan Selatan 98,0 98,8
23 Kalimantan Timur 96,0 96,1
24 Kalimantan Utara 75,6 90,5
25 Sulawesi Utara 96,0 95,9
26 Sulawesi Tengah 89,1 92,1
27 Sulawesi Selatan 89,6 93,1
28 Sulawesi Tenggara 81,9 88,1
29 Gorontalo 99,9 100,0
30 Sulawesi Barat 91,3 96,3
31 Maluku 81,9 92,0
32 Maluku Utara 64,9 85,5
33 Papua Barat 96,4 73,6
34 Papua 20,4 65,7'

dat6 <- read_pattern(
  s6, pos_non_angka = 2,
  pos_angka = c(1, 3:4)
) %>% 
  mutate_at(-2, ~str_replace_all(.x, ',', '\\.')) %>% 
  type_convert() %>% 
  dplyr::select(
    v2, kek = v4
  )
dat6

s7 <- '1 Aceh 359 289 1,2
2 Sumatera Utara 608 450 1,4
3 Sumatera Barat 276 179 1,5
4 Riau 231 169 1,4
5 Jambi 207 141 1,5
6 Sumatera Selatan 343 241 1,4
7 Bengkulu 179 129 1,4
8 Lampung 312 228 1,4
9 Kepulauan Bangka Belitung 64 47 1,4
10 Kepulauan Riau 88 75 1,2
11 DKI Jakarta 315 44 7,2
12 Jawa Barat 1.083 627 1,7
13 Jawa Tengah 878 576 1,5
14 DI Yogyakarta 121 78 1,6
15 Jawa Timur 968 666 1,5
16 Banten 245 155 1,6
17 Bali 120 57 2,1
18 Nusa Tenggara Barat 174 117 1,5
19 Nusa Tenggara Timur 410 309 1,3
20 Kalimantan Barat 246 174 1,4
21 Kalimantan Tengah 205 136 1,5
22 Kalimantan Selatan 236 153 1,5
23 Kalimantan Timur 187 103 1,8
24 Kalimantan Utara 55 53 1,0
25 Sulawesi Utara 195 171 1,1
26 Sulawesi Tengah 207 175 1,2
27 Sulawesi Selatan 461 311 1,5
28 Sulawesi Tenggara 292 219 1,3
29 Gorontalo 93 77 1,2
30 Sulawesi Barat 96 69 1,4
31 Maluku 215 118 1,8
32 Maluku Utara 147 116 1,3
33 Papua Barat 161 218 0,7
34 Papua 428 560 0,8'

dat7 <- read_pattern(
  s7, pos_non_angka = 2,
  pos_angka = c(1, 3:5)
) %>% 
  mutate_at(-2, ~str_replace_all(.x, ',', '\\.')) %>% 
  type_convert() %>% 
  dplyr::select(
    v2, rp = v5
  )
dat7


s8 <- '1 Aceh 2.107 5.202 7.309 13.305 2.502 4.984 7.486 3.500 131 104 235 166 4.740 10.290 15.030 16.971
2 Sumatera Utara 2.085 5.237 7.322 15.630 3.017 8.885 11.902 4.072 130 183 313 254 5.232 14.305 19.537 19.956
3 Sumatera Barat 487 2.315 2.802 5.360 1.172 5.393 6.565 1.371 50 162 212 145 1.709 7.870 9.579 6.876
4 Riau 903 2.535 3.438 4.898 1.451 4.046 5.497 1.795 52 97 149 149 2.406 6.678 9.084 6.842
5 Jambi 1.032 2.384 3.416 4.913 1.027 2.857 3.884 1.181 123 177 300 266 2.182 5.418 7.600 6.360
6 Sumatera Selatan 1.503 4.414 5.917 9.773 1.641 5.960 7.601 2.400 113 156 269 184 3.257 10.530 13.787 12.357
7 Bengkulu 585 1.465 2.050 2.848 746 1.621 2.367 860 57 88 145 96 1.388 3.174 4.562 3.804
8 Lampung 1.710 2.550 4.260 7.461 2.096 3.701 5.797 1.669 112 147 259 254 3.918 6.398 10.316 9.384
9 Kep. Bangka Belitung 307 703 1.010 940 618 1.386 2.004 424 104 163 267 102 1.029 2.252 3.281 1.466
10 Kepulauan Riau 291 867 1.158 1.309 716 2.158 2.874 693 51 78 129 51 1.058 3.103 4.161 2.053
11 DKI Jakarta 500 1.449 1.949 1.867 5.452 23.174 28.626 3.436 614 1.038 1.652 1.017 6.566 25.661 32.227 6.320
12 Jawa Barat 4.705 6.058 10.763 15.888 12.963 28.801 41.764 7.517 618 927 1.545 1.618 18.286 35.786 54.072 25.023
13 Jawa Tengah 3.564 5.858 9.422 16.096 12.132 27.407 39.539 6.976 1.055 2.622 3.677 2.537 16.751 35.887 52.638 25.609
14 DI Yogyakarta 281 647 928 953 1.758 5.964 7.722 1.064 99 415 514 313 2.138 7.026 9.164 2.330
15 Jawa Timur 6.373 8.568 14.941 16.394 13.023 25.224 38.247 7.514 952 1.693 2.645 1.318 20.348 35.485 55.833 25.226
16 Banten 1.045 1.356 2.401 3.884 2.648 7.703 10.351 2.133 157 236 393 445 3.850 9.295 13.145 6.462
17 Bali 539 1.115 1.654 2.368 2.431 5.736 8.167 2.123 216 508 724 407 3.186 7.359 10.545 4.898
18 Nusa Tenggara Barat 1.842 2.769 4.611 4.310 1.507 2.561 4.068 1.167 175 142 317 90 3.524 5.472 8.996 5.567
19 Nusa Tenggara Timur 1.671 3.841 5.512 5.640 780 2.709 3.489 1.173 73 82 155 48 2.524 6.632 9.156 6.861
20 Kalimantan Barat 1.868 2.104 3.972 3.694 1.522 2.737 4.259 1.024 96 95 191 119 3.486 4.936 8.422 4.837
21 Kalimantan Tengah 1.550 2.099 3.649 3.020 963 1.829 2.792 732 104 94 198 76 2.617 4.022 6.639 3.828
22 Kalimantan Selatan 1.090 1.492 2.582 3.370 2.170 3.084 5.254 1.303 144 99 243 88 3.404 4.675 8.079 4.761
23 Kalimantan Timur 797 1.595 2.392 2.292 1.762 4.256 6.018 1.253 39 88 127 67 2.598 5.939 8.537 3.612
24 Kalimantan Utara 321 594 915 713 297 693 990 271 37 50 87 25 655 1.337 1.992 1.009
25 Sulawesi Utara 409 2.080 2.489 1.467 1.030 3.451 4.481 659 74 165 239 33 1.513 5.696 7.209 2.159
26 Sulawesi Tengah 972 2.187 3.159 3.946 953 2.576 3.529 1.209 118 130 248 60 2.043 4.893 6.936 5.215
27 Sulawesi Selatan 1.369 5.488 6.857 8.203 2.395 9.214 11.609 2.933 168 337 505 246 3.932 15.039 18.971 11.382
28 Sulawesi Tenggara 961 2.709 3.670 3.879 752 2.084 2.836 965 48 90 138 69 1.761 4.883 6.644 4.913
29 Gorontalo 257 691 948 1.027 417 1.052 1.469 455 39 52 91 46 713 1.795 2.508 1.528
30 Sulawesi Barat 486 1.341 1.827 2.405 307 874 1.181 445 24 56 80 56 817 2.271 3.088 2.906
31 Maluku 695 1.871 2.566 1.415 434 1.522 1.956 474 72 116 188 45 1.201 3.509 4.710 1.934
32 Maluku Utara 448 872 1.320 1.919 303 856 1.159 453 35 47 82 33 786 1.775 2.561 2.405
33 Papua Barat 575 1.079 1.654 1.063 396 965 1.361 365 25 22 47 17 996 2.066 3.062 1.445
34 Papua 1.374 2.116 3.490 2.201 669 1.819 2.488 632 100 85 185 72 2.143 4.020 6.163 2.905
'

bidan <- dm::read_pattern(
  s8, pos_angka = c(1),
  pos_non_angka = 2:18
) %>% 
  mutate_at(18, ~str_remove_all(.x, '\\.')) %>% 
  type_convert() %>% 
  pull(v18)


s9 <- '1 Aceh 5.371.532 69 8.576 1,6 5.371.532 70 9.311 1,7 
2 Sumatera Utara 14.562.549 217 21.979 1,5 14.562.549 222 24.838 1,7 
3 Sumatera Barat 5.441.197 78 7.043 1,3 5.441.197 79 8.092 1,5 
4 Riau 6.971.745 74 6.811 1,0 6.971.745 73 8.467 1,2 
5 Jambi 3.624.579 40 4.038 1,1 3.624.579 42 4.701 1,3 
6 Sumatera Selatan 8.470.683 84 8.996 1,1 8.470.683 87 10.583 1,2 
7 Bengkulu 1.991.838 24 2.618 1,3 1.991.838 25 2.904 1,5 
8 Lampung 8.447.737 78 7.640 0,9 8.447.737 80 8.391 1,0 
9 Kep. Bangka Belitung 1.488.792 25 2.061 1,4 1.488.792 25 2.160 1,5 
10 Kepulauan Riau 2.189.653 33 3.048 1,4 2.189.653 36 3.712 1,7 
11 DKI Jakarta 10.557.810 190 23.664 2,2 10.557.810 193 32.284 3,1 
12 Jawa Barat 49.316.712 361 43.042 0,9 49.316.712 377 54.137 1,1 
13 Jawa Tengah 34.718.204 304 40.921 1,2 34.718.204 319 47.923 1,4 
14 DI Yogyakarta 3.842.932 83 6.578 1,7 3.842.932 85 7.219 1,9 
15 Jawa Timur 39.698.631 384 44.069 1,1 39.698.631 395 51.504 1,3 
16 Banten 12.927.316 116 11.222 0,9 12.927.316 120 13.881 1,1 
17 Bali 4.336.923 68 6.913 1,6 4.336.923 72 8.183 1,9 
18 Nusa Tenggara Barat 5.070.385 37 3.767 0,7 5.070.385 39 4.510 0,9 
19 Nusa Tenggara Timur 5.456.203 52 4.531 0,8 5.456.203 54 5.052 0,9 
20 Kalimantan Barat 5.069.127 51 5.507 1,1 5.069.127 55 5.922 1,2 
21 Kalimantan Tengah 2.714.859 26 2.556 0,9 2.714.859 28 3.885 1,4 
22 Kalimantan Selatan 4.244.096 46 5.130 1,2 4.244.096 47 6.187 1,5 
23 Kalimantan Timur 3.721.389 55 6.091 1,6 3.721.389 57 7.551 2,0 
24 Kalimantan Utara 742.245 10 1.085 1,5 742.245 11 1.177 1,6 
25 Sulawesi Utara 2.506.981 47 5.378 2,1 2.506.981 51 6.706 2,7 
26 Sulawesi Tengah 3.054.023 38 4.409 1,4 3.054.023 40 4.833 1,6 
27 Sulawesi Selatan 8.851.240 111 14.233 1,6 8.851.240 116 16.723 1,9 
28 Sulawesi Tenggara 2.704.737 36 2.822 1,0 2.704.737 37 3.496 1,3 
29 Gorontalo 1.202.631 14 2.001 1,7 1.202.631 16 2.335 1,9 
30 Sulawesi Barat 1.380.256 12 1.266 0,9 1.380.256 13 1.496 1,1 
31 Maluku 1.802.870 30 2.126 1,2 1.802.870 33 3.109 1,7 
32 Maluku Utara 1.255.771 21 1.418 1,1 1.255.771 21 1.608 1,3 
33 Papua Barat 959.617 19 1.402 1,5 959.617 20 2.160 2,3 
34 Papua 3.379.302 44 4.055 1,2 3.379.302 47 4.508 1,3 '

jp <- dm::read_pattern(
  s9, pos_non_angka = 2:10,
  pos_angka = c(1)
) %>% 
  mutate_at(7, ~str_remove_all(.x, '\\.')) %>% 
  type_convert() %>% 
  pull(v7)
jp

