s <- "10 - 14 119,565 205 34 15 119,819 
15 - 19 124,293 12,414 324 90 137,121 
20 - 24 74,557 75,967 1,230 372 152,126 
25 - 29 34,753 131,615 1,908 806 169,082 
30 - 34 14,843 126,191 2,071 1,267 144,372 
35 - 39 9,162 110,664 2,274 2,268 124,368 
40 - 44 6,080 90,124 1,936 3,836 101,976 
45 - 49 4,181 69,064 1,622 5,206 80,073 
50 - 54 3,441 55,173 1,515 7,501 67,630 
55 - 59 2,731 41,671 1,234 8,917 54,553 
60 - 64 2,505 31,837 1,241 13,092 48,675 
65 + + 4,703 45,239 2,383 42,423 94,748 "

df <-
  read.table(textConnection(s), header = F, dec = ".") %>%
  mutate(
    umur = paste0(V1, V2, V3),
    .before = V3, .keep = "unused"
  ) %>%
  type_convert() %>%
  `colnames<-`(c(
    "umur", "single", "menikah",
    "cerai_hidup", "cerai_mati", "total"
  ))


s <- "5500	620	20	6142	89,5473787
3300	2600	70	5978	55,20240883
1600	5000	120	6740	23,7388724
570	5500	140	6250	9,12
300	5100	150	5620	5,338078292
150	4600	140	5030	2,982107356
90	3900	120	4320	2,083333333
60	3000	100	3480	1,724137931"

df <- read.table(textConnection(s), header = F)

smam <- function(single, total, n = 5, dari = 15) {
  if (dari == 15) {
    p1 <- 7
    p2 <- 8
  }
  else if (dari == 10) {
    p1 <- 8
    p2 <- 9
  }

  df <- data.frame(si = single * 100 / total)
  smam_value <- df %>%
    summarise(
      smam = (dari * 100 + n * sum(si[1:p1]) - 50 * mean(si[p1:p2])) / (100 - mean(si[p1:p2]))
    ) %>%
    pull()

  return(list(data = df, smam = smam_value))
}

smam(df$V1, df$V4, dari = 15)


s <- "15-19 119.554 7.900 0,02880 0,43584 0,30000 3.443 35.866 2.370 3.443
20-24 147.496 74.273 0,10910 0,21666 0,55000 16.092 81.123 40.850 16.092
25-29 154.148 122.472 0,12970 0,16325 0,50200 19.993 77.382 61.481 19.993
30-34 154.738 139.621 0,08770 0,09720 0,44700 13.571 69.168 62.411 13.571
45-49 136.450 127.674 0,03270 0,03495 0,40600 4.462 55.399 51.836 4.462
40-44 118.056 109.833 0,01160 0,01247 0,22200 1.369 26.208 24.383 1.369
45-49 103.515 98.874 0,00230 0,00241 0,06100 238 6.314 6.031 238"

read.table(textConnection(s), header = F) %>%
  mutate_all(~ str_replace_all(.x, ",", ".")) %>%
  type_convert() %>%
  write.table("clipboard",
    dec = ",", row.names = F,
    col.names = F, sep = "\t"
  )


copy2c <- function(df, dec = ",", rownames = F, colnames = F, ...) {
  write.table(df, "clipboard",
    dec = dec, row.names = rownames,
    col.names = colnames, sep = "\t",
  )
}
