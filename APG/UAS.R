s1 <- '0.2491566 0.6171983 0.4978255 -0.3249063 0.45121271
0.1702028 0.68810162 -0.5657527 0.2329370 -0.38916355
0.5262830 -0.17174787 -0.4394400 -0.7366827 -0.06153953
0.5641733 -0.05518826 0.4682750 0.3577607 -0.59015196
0.5600773 -0.19481462 -0.1403732 0.4116822 0.54119532'

library(dm)
eig_vec <- read_string(s1) 
eig_vec %>% 
  .^2 %>% 
  rowSums()

5 - (2.64809262 + .25246223 + 0.03805297 + 0.44561001)


X <- eigen(R)
X
X$values <- eig %>% as.numeric()
X$vectors <- as.matrix(eig_vec) %>% `colnames<-`(NULL) %>% as.numeric()

X
psych::fa(X, nfactors = 2, fm = 'pa')
factanal(covmat = cov(iris[-5]), factors = 1)

degree_sigma(X, 1)

s <- '0.4054515 0.8136 0.3323186 -0.1632512 0.08801884
0.2769704 0.915 -0.3776627 0.1170406 -0.07591480
0.8564184 -0.21831459 -0.2933439 -0.3701508 -0.01200462
0.9180771 -0.07015169 0.3125924 0.1797591 -0.11512196
0.9114117 -0.24763553 -0.0937048 0.2068523 0.10557190'

read_string(s) %>% 
  .^2 %>% 
  colSums()

read_string(s) %>% 
  colMeans()

f <- read_string(s) 
rowSums(f^2)
colMeans(f)

e12 <- 1 - (0.2491566^2 + 0.4978255^2 + (-0.3249063)^2 + 0.45121271^2)
e12
sqrt(e12)


eig <- c(2.64809285, 1.615782, 0.44561001, 0.25246228, 0.03805298 )
cumsum(eig/sum(eig))
# No 2 --------------------------------------------------------------------

dat <- readxl::read_xlsx('D:/Downloads/20220620_3_3SK APG-1655675531603/Data_TernakJabar16.xlsx')
df <- dat[-1]
fviz_nbclust(df[-1], kmeans, method = "wss")

k5 <- kmeans(df, centers = 5)
fviz_cluster(k5, geom = "point", data = df) + ggtitle("k = 5")
p5

al <- hclust(dist(df), method = 'ward')
plot(al)
# ---------------------------------------------------------------------
z <- - 1.273 + 0.041*49 + 0.07 * 171.23 + 34.04 * -0.44
z

a <- c(- 1.273, 0.041, 0.07, -0.44)
h <- as.numeric(t(a) %*% (xbar1 + xbar2) / 2)
h


xbar1 <- 